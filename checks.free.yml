# MatrixConfig
# The optimized config for Matrix Anticheat, a powerful anticheat for Minecraft.
# For Matrix 5.1.1+
#
# Authors: Encode42, gowgotz.
#
# This config may not work perfectly with your server.
# Plugins, software, performance can all effect how well this config and the anticheat in general will work.
# This is not a drag-and-drop solution! Some values may need to be changed to work best with your setup.
#
# Matrix Anticheat isn't a perfect anticheat. It itself has bugs that we cannot fix.
# This config aims to mitigate those issues and improve what works well, but there's only so much we can do.
# Tested and configurated for survival and minigame servers. Tweak the config for your own server!
#
# --------------------------------------------
#                  Issues?
# Follow the FAQ's in README.md. (Question #2)
# --------------------------------------------
#
# GitHub: https://github.com/Encode42/MatrixConfig
# Discord: https://discord.gg/rjSkFyj

## KillAura
# Prevents the player from using the KillAura/AimBot hack.
killaura:
  enable: true

  # Modules used in the KillAura checks
  modules:
    # OneHit check: Detects some blatant KillAura cheats in short time.
    onehit:
      enable: true

      # How many violations will be added when triggered?
      vl_weight: 4

      # Disable if there are false positives when players have high latency.
      disable_packet_order_check: false

      # Disable if there are false positives for some players who click fast.
      disable_dead_hit_check: false

    # AutoClicker check: Prevents players using an AutoClicker/macro.
    autoclicker:
      # Players can click 22 times per second if they jitter clicking.
      # The average player clicks at 8 CPS, and only a very small amount of people get to 16 CPS.
      # 
      # Decrease if players are bypassing, increase if legit players are getting flagged.
      # Lag may influence the detected CPS, set this number 1-2 higher than what you want.
      max_cps: 18

      # Enable if you don't care about AutoClicker/macros working on mobs.
      not_check_attacking_mobs: false

      # How many violations will be added when triggered?
      vl_weights:
        cps: 8
        delay: 4 # Might cause false flags when jitter clicking. (-1 = disable)
        cps_long: 6
        v19plus: 6

    # Click check: Makes sure players don't have impossible accuracy.
    click:
      enable: true

      # How many violations will be added when triggered?
      vl_weight: 30

      # How sensitive this check will be (0, 1, 2)
      # 0: High sensitivity. Detects many types of KillAura, but there are many false flags. (Not recommended)
      # 1: Medium sensitivity. Detects most types of KillAura with low false positives.
      # 2: Low sensitivity. Detects most types of KillAura, but is slow.
      sensitivity: 1

    # NPC check: Generates a fake player behind the player to detect if the player can swing at it.
    # Only the targeted player can see the NPC!
    npc:
      enable: true

      # How many violations will be added when triggered?
      # This should be a higher number because nobody should be able to swing 180 degress behind them.
      vl_weight: 12

      # This decreases server load, but there may be a delay if the player turns quickly.
      async: true

      # Should NPCs use real entity IDs instead of randomly generating them?
      # Some cheating clients can bypass random entity ID.
      real_entity_id: true

      # Disables automatic spawing of NPCs. Disable this if you want Matrix to handle NPC spawing.
      # NPC command: "/matrix npc <player> <duration>"
      only_command_trigger: true

      # Makes the NPC visible. Most clients do not attack invisible entities.
      # Disabling will make less players confused, but the check less reliable.
      visible: true

      # Force a random name instead of the name of an online player.
      # Some clients detect duplicate online players.
      #
      # Enabling may cause issues if you have modified teams set up.
      # To make the NPCs support random names with teams, you must use the API.
      force_random_name: false

      # NPC existence time (ticks)
      check_ticks:
        base: 100
        attack_add: 30
        hit_bot_add: 55

      # NPC motion settings
      movement:
        distance_base: 3.2
        distance_random_size: 0.75
        distance_attack_base: 3.0
        move_up_after_attack: false

    # Machine Learning check: Uses machine learning clustering to better detect hacks.
    # Matrix provides a trained model by default. You can also train a model yourself for better server-specific checks.
    # Training tutorial: https://github.com/jiangdashao/Matrix-Issues/wiki/Machine-Learning-KillAura-check-Training-Tutorial
    #
    # Note: This check is more useful on 1.8.X servers. It still works on 1.9+, but with less effectiveness.
    machine_learning:
      enable: true

      # How many violations will be added when triggered?
      vl_weight: 8

      # Which samples to disable.
      #
      # Example:
      # disable_patterns:
      #  - "#66"
      #  - "#67"
      disable_patterns: {}

      # Duration of data collection (ms)
      # Longer collection time means slower detection but better accurucy.
      collect_data_duration: 6000

      # Data set availability threshold
      # If the collected data set is below the threshold, discard the data set.
      availability_threshold:
        hits: 5 # The player must attack the entity X times.
        clicks: 30  # The player must click the mouse X times
        rotations: 90 # The player must rotate the head X times

    # NoSwing check: Makes sure player has a swing animation.
    noswing:
      enable: true

      # How many violations will be added when triggered?
      vl_weight: 4

    # Critical check: Prevents players from making abnormal crit attacks.
    critical:
      enable: true

      # How many violations will be added when triggered?
      vl_weight: 5

    # Snap check: Checks players for abnormal fast aiming actions.
    snap:
      enable: true

      # How many violations will be added when triggered?
      vl_weight: 5

    # Click AimBot check: Detects players keeping 100% accuracy when clicking.
    clickaimbot:
      enable: true

      # How many violations will be added when triggered?
      vl_weight: 5

    # AimAssist check: Detects simple aim hacks.
    aimassist:
      enable: true

      # How many violations will be added when triggered?
      vl_weight: 10

    # Aim check: Detects if player aiming is normal based on an algorithm.
    aim:
      enable: true

      # How many violations will be added when triggered?
      vl_weight: 15

    # Direction check: Detects if aiming in player battle is normal based on motion prediction.
    direction:
      enable: true

      # How many violations will be added when triggered?
      vl_weight: 3

    # Smooth check: Checks if the player's aim is too smooth.
    smooth:
      enable: true
      
      # How many violations will be added when triggered?
      vl_weight: 15

    # Combine check: Adds additional violations if multiple checks are triggered at once
    combine:
      test:
        # How long to check for conditions.
        time: 5000
        
        # What conditions to combine.
        condition:
          - 'ka.one.11'
          - 'ka.smt'
          
        # How many violations will be added when triggered?
        action: 8

  # Violation Thresholds.
  # Run commands once X amount of violations are reached.
  commands:
    8: 'matrix npc %player% 125'
    20: 'matrix notify %player% might be using combat hacks &8| &7KillAura &8| &61/3'
    35: 'matrix notify %player% might be using combat hacks &8| &7KillAura &8| &c2/3'
    42: 'matrix delay 12 matrix kick %player% KillAura'

## HitBox
# Prevents players from using HitBox, Angle, and Reach hacks.
# Note: This check is only strict when you attack other players, and loose when you attack other entities.
hitbox:
  enable: true

  # Maximum reach distance.
  # The max reach distance in Minecraft is 3.5 blocks, however it's calculated in a strange way so most player's won't reach that far.
  # Anything farther than 3.4 blocks should be considered hacks, however players may still reach that far.
  max_reach: 3.2

  # How many moves should the Matrix trace back to the player?
  # You can set this higher to reduce false positives, but this will weaken HitBox detection.
  # Do not set higher than 10, as that'll make this check useless.
  trace_back_length: 3

  # When should this check ignore players with high ping?
  # Players with high ping may trigger false flags.
  max_ping: 250

  # How many violations will be added when triggered?
  vl_weights:
    miss_player_hitbox: 2
    reach_target_standing: 10
    reach_target_moving: 3
    reach_simple: 3

  # Dynamic violations changes the VL weights based on the amount of reach.
  # Flayers get X vl when using 3.5 reach, and X + 10 vl when using 5.0 reach.
  # If enabled, "reach_target_standing" and "reach_target_moving" will no longer be used.
  # Note: Dynamic VL = "(current_reach - max_reach) * expander"
  dynamic_vl:
    enable: true
    expander: 10
    min_vl: 5
    max_vl: 19

  # Violation Thresholds.
  # Run commands once X amount of violations are reached.
  commands:
    10: 'matrix notify %player% tried to reach entity outside max reach distance &8| &7HitBox &8| &a1/3'
    13: 'coc %player% if -tps->18.5&-ping-<185 do matrix npc %player% 125' # Spawns an anti-killaura NPC if the ping doesn't exceed 185ms and the server isn't lagging.
    15: 'matrix notify %player% tried to reach entity outside max reach distance &8| &7HitBox &8| &c2/3'
    22: 'matrix kick %player% Reach/HitBox Hacks'

## Movement Speed Check
# Prevents players from moving too fast.
speed:
  enable: true

  # Ignores unloaded chunks.
  ignore_unloaded_chunks: true

  # Speed prediction tolerance.
  tolerance: 0.01

  # Allows Matrix to not check the blocks and collision boxes around the player every tick and instead use cached results.
  # Do not set this too big! Too many skips will occur and cause false positives. (0 = no skips)
  skip_rate: 2

  # How many violations are needed to cancel illegal movements?
  cancel_vl: 45

  # Ensures correct sprint direction.
  sprint_direction: true

  # Ensures correct strafe movement.
  strafe: true

  # Checks for FastClimb/FastLadder
  fastclimb: true

  # Checks for NoSlow.
  check_noslow: true

  # Violation Thresholds.
  # Run commands once X amount of violations are reached.
  commands:
    55: 'matrix notify %player% tried to move faster than usual &8| &7Speed &8| &a1/3'
    90: 'matrix notify %player% tried to move faster than usual &8| &7Speed &8| &c2/3'
    220: 'matrix kick %player% Speed Hacks'

## Fly
# Prevents the player from using both vanilla and non-vanilla fly hacks.
fly:
  # Note: Speed check must also be enabled.
  enable: true

  # How many violations are needed to cancel illegal movements?
  cancel_vl: 48

  # Checks if players are allowed to fly.
  # Note: Might be not compatible with some plugins.
  ability:
    enable: true
    vl_weight: 20

  # Teleports players to the void if they are close to it.
  # May cause NoFall/BugUp bypasses if disabled and won't teleport players in sky based gamemodes.
  setback_to_void: true

  # NoFall check: Makes sure players receive damage when falling.
  # Recommended to disable these for minigame servers that don't have fall damage enabled.
  nofall:
    # Teleports players back to original position.
    setback: true
  
    # Deals the same amount of damage after detection.
    damage: true

  # How many violations will be added when trident boost hacks are triggered?
  trident_boost_vl_weight: 20

  # Setback method (back/ground)
  # back: Teleport to the last legit location
  # ground: Teleports to the ground under the player
  setback: back

  # Violation Thresholds.
  # Run commands once X amount of violations are reached.
  commands:
    50: 'matrix notify %player% tried to fly &8| &7Fly &8| &a1/3'
    100: 'matrix notify %player% tried to fly &8| &7Fly &8| &c2/3'
    180: 'matrix kick %player% Fly Related Hacks'


## BadPackets
# Prevents players from sending too many movement packets or sending illegal packets.
badpackets:
  enable: true

  # Buffer Size (ticks)
  # The larger the value, the slower the detection, but the more stable.
  # Don't set this less than 10.
  buffer_size: 32

  # Freeze time (ms)
  # How long to freeze player if they try to send too many movement packets.
  freeze_time: 500

  # How many extra packets can the player send?
  max_extra_packets: 20

  # How many violations will be added when triggered?
  vl_weights:
    limit: 10
    timer: 10

  # Violation Thresholds.
  # Run commands once X amount of violations are reached.
  commands:
    100: 'matrix notify %player% is sending unusual packets to the server &8| &7BadPackets &8| &a1/3'
    150: 'matrix notify %player% is sending unusual packets to the server &8| &7BadPackets &8| &c2/3'
    240: 'matrix kick %player% Sending Unusual Packets'

## FastUse
# Check prevents player from eating or using an item too quickly.
fastuse:
  # Enable this check?
  enable: true

  # Violations needed to cancel illegal item use (-1 = never cancel)
  cancel_vl: 1

  # Violation weight
  vl_weight: 1

  # Violation Thresholds
  # number_of_violations: '<command>'
  commands:
    5: 'matrix notify %player% tried to use an item faster than usual &8| &7FastUse &8| &a1/2'
    24: 'matrix kick %player% FastUse Hacks' # Decrease if it takes a long time to detect, or increase if causes false positives.

## FastBow
# Check prevents player from shooting a bow too quickly.
fastbow:
  # Enable this check?
  enable: true

  # Violations needed to cancel illegal bow use (-1 = never cancel)
  cancel_vl: 7

  # Violation Weight
  vl_weight: 1

  # Violation Thresholds
  # number_of_violations: '<command>'
  commands:
    5: 'matrix notify %player% is trying to shoot a bow too quickly &8| &7FastBow &8| &a1/2'
    15: 'matrix kick %player% FastBow Hacks'

## FastHeal
# Check prevents player from regaining health too quickly.
# May cause false positives, but RE says the check has been improved.
# Disable this if it causes false positives.
# Also blocked by BadPackets
fastheal:
  # Enable this check?
  enable: true

  # Violation Weight
  vl_weight: 2

  # Violation Thresholds
  # number_of_violations: '<command>'
  commands:
    10: 'matrix notify %player% tried to regain health too quickly &8| &7FastHeal &8| &a1/2'
    48: 'matrix kick %player% FastHeal Hacks'

## Block
# Check prevents the player from breaking, placing block quickly
block:
  # Enable this check?
  enable: true

  # Violations needed to cancel illegal breaking/placing of blocks (-1 = never cancel)
  # Set to 8 to prevent falling to void in case of things like SkyWars matches and others.
  cancel_vl: 8

  # Modules List
  # You can turn off some modules here
  modules:
    # It can detect player breaking block faster
    fastbreak:
      enable: true
      vl_weight: 4
    # It can detect player placing block faster
    fastplace:
      enable: true
      vl_weight: 1
      max_place_per_second: 16 # Some players can place 18 blocks per second; feel free to decrease or increase that.
    # It can detect player placing block without swing hand
    noswing:
      enable: true
      vl_weight: 1
    # detect player not send abort breaking packet
    abort:
      enable: true
      vl_weight: 0

  # Violation Thresholds
  # number_of_violations: '<command>'
  commands:
    10: 'matrix notify %player% tried to place/break a block too quickly &8| &7Block &8| &a1/2'
    32: 'matrix kick %player% FastPlace/FastBreak Hacks'

## Scaffold check
# Check prevents player bridging blocks or towering up faster than normal speed
place:
  # Enable this check
  enable: true

  # Cancel VL
  cancel_vl: 15

  # Modules
  modules:
    # It can detect player bridging faster
    scaffold:
      enable: true
      vl_weight: 9
      
    # Preventing player bridging too fast
    delay:
      enable: true
      vl_weight: 6
      cancel_place: true
      
      # Turn this down if legit players are getting violations
      min_delay: 7

    # Preventing player right clicking fast
    right_cps:
      enable: true
      vl_weight: 5
      
    # It can detect player towering up faster
    tower:
      enable: true
      vl_weight: 2

  # Violation Thresholds
  # number_of_violations: '<command>'
  commands:
    10: 'matrix notify %player% tried to bridge blocks quickly &8| &7Scaffold &8| &a1/3'
    15: 'matrix notify %player% tried to bridge blocks quickly &8| &7Scaffold &8| &c2/3'
    32: 'matrix kick %player% Scaffold/Tower'

## Jesus
# Check prevents the player from moving too too quickly in liquids, or walking on liquid.
# ^^ I wouldn't disable the check anyway - that false positive is rare in most cases.
jesus:
  # Enable this check?
  enable: true

  # Violations needed to cancel illegal movements (-1 = never cancel)
  cancel_vl: 15

  # Should Matrix ignore whether player is in swimming?
  # This feature can prevent swimming status desync
  ignore_swim_pose: true

  # Violation Thresholds
  # number_of_violations: '<command>'
  commands:
    20: 'matrix notify %player% tried to move illegally in liquid &8| &7Jesus &8| &a1/3'
    40: 'matrix notify %player% tried to move illegally in liquid &8| &7Jesus &8| &c2/3'
    64: 'matrix kick %player% Jesus/WaterSpeed/WaterFly Hacks'

## Inventory
# Check prevents the player from using illegal inventory modifications such as Steal.
# Also prevents quick inventory movement hacks.
inventory:
  # Enable this check?
  enable: true

  # Violations needed to cancel illegal movements of items (-1 = never cancel)
  # Strict for SkyWars matches
  cancel_vl: 8

  # Enable ChestStealer check?
  # It can detect player taking items out of chest faster
  chest_stealer: true

  # Ignore items/inventory which has colorful name
  # This feature can prevent false positive when you
  # click some GUI such as the Bedwars Shop
  ignore_color: false

  # Disable InventoryMove check
  # If you don't need InventoryMove check, you can set this to 'true' to disable it
  # This option ONLY works for 1.12/1.13/+ server
  disable_invmove: false

  # Check AutoTotem cheat?
  auto_totem: true

  # Violation Thresholds
  # number_of_violations: '<command>'
  commands:
    10: 'matrix notify %player% moved items in inventory too quickly &8| &7Inventory/ChestSteal &8| &a1/2'
    24: 'matrix kick %player% ChestSteal/Inventory Hacks'

## Velocity
# Check prevents the player from using any type of anti-knockback hacks.
velocity:
  # Enable this check?
  enable: true

  # The time to wait for players to respond to velocity (ticks)
  # If the player does not respond to velocity after that
  # time, the player will be detected.

  # Set to 40 to not cause false positives for laggy players.
  wait_time: 40

  # Ignore lag player, this feature can ignore the player who
  # is lagging or changing resource pack.
  ignore_lag: true

  # The VL weight of velocity check modules (-1 = disable)
  modules:
    respond: 5
    analyser: 3
    vertical: 1

  # Violation Thresholds
  # number_of_violations: '<command>'
  commands:
    10: 'matrix notify %player% tried to not take knockback &8| &7Velocity &8| &a1/3'
    15: 'matrix notify %player% tried to not take knockback &8| &7Velocity &8| &c2/3'
    22: 'matrix kick %player% Velocity/Anti-Knockback'

## Spam
# Check prevents a player from spamming messages in the servers chat.
chat:
  # Enable this check?
  enable: true

  # Minimum amount of time between messages (Seconds)
  min_time: 2

  # Violations needed to cancel sent messages (-1 = never cancel)
  cancel_vl: 4

  # Violation Thresholds
  # number_of_violations: '<command>'
  commands:
    4: 'matrix notify %player% is spamming the chat &8| &7ChatSpam &8| &a1/2'
    10: 'matrix kick %player% Spammer/ChatBot'

## Interact
# Check prevents the player from illegally interacting with entities and blocks.
interact:
  # Enable this check?
  enable: true

  # Modules List
  modules:
    # It can detect player breaking blocks through walls
    break_block:
      enable: true
      vl_weight: 1
    # It can detect player attacking other entities through walls
    attack:
      enable: true
      vl_weight: 1
    # It can detect player interacting blocks too far away
    block_reach:
      enable: true
      vl_weight: 1

  # Violation Thresholds
  # number_of_violations: '<command>'
  commands:
    10: 'matrix notify %player% tried to illegally interact with an entity or block &8| &7Interact &8| &a1/2'
    24: 'matrix kick %player% Illegally Interacting with Block/Entity'

## AutoFish
# Check prevents the player from using an Auto-Fishing mod or hack.
autofish:
  # Enable this check?
  enable: true

  # Violations needed to cancel auto fishing (-1 = never cancel)
  cancel_vl: 5

  # Violation Thresholds
  # number_of_violations: '<command>'
  commands:
    6: 'matrix notify %player% is using auto fish mods &8| &7AutoFish &8| &a1/2'
    14: 'matrix kick %player% AutoFish'

## Phase
# Check prevents the player people glitching through blocks.
phase:
  # Enable this check?
  enable: true

  # How much time should Matrix prevent the player from moving if
  # the player frequently tries to move the block? (milliseconds)
  freeze_time: 400

  # Violations needed to cancel illegal movements
  cancel_vl: 5

  # Should Matrix prevent players from using Ender Pearl for close range teleportation?
  prevent_close_range_enderpearl: true

  # Exclude specific block types
  exclude_types: []

  # Violation Thresholds
  # number_of_violations: '<command>'
  commands:
    7: 'matrix notify %player% is glitching through blocks &8| &7Phase &8| &a1/2'
    13: 'matrix notify %player% is glitching through blocks &8| &7Phase &8| &c2/2'
    # No kick action; the check is not stable yet.

## AutoBot
# Check prevents player use some Bot mods like Baritone
# NOTE: THIS CHECK IS ONLY WORK FOR PREMIUM USERS
# Doesn't work for 1.8 (maybe?)
autobot:
  # Enable this check?
  enable: true

  # Violation Thresholds
  # number_of_violations: '<command>'
  commands:
    5: 'matrix notify %player% suspected use of automatic robots &8| &7AutoBot &8| &a1/3'
    10: 'matrix notify %player% suspected use of automatic robots &8| &7AutoBot &8| &c2/3'
    15: 'matrix kick %player% Auto-Bot'

## Elytra
# Checks prevents player using Elytra+, ElytraFlight, etc
# Only works for 1.9+
elytra:
  # Enable this check?
  enable: true

  # Should Matrix be forced to pull back players who are particularly
  # cheating? Even if they do not reach cancel_vl (default: true)
  force_setback: true

  # Setback violation level (-1 = never setback)
  setback_vl: 8

  # unequip elytra VL
  # If player reached this VL, Matrix will make it out of the gliding state (-1 = disable this feature)
  unequip_vl: 20

  # Violation Thresholds
  # number_of_violations: '<command>'
  commands:
    10: 'matrix notify %player% suspected using elytra-related cheats &8| &7Elytra &8| &a1/3'
    20: 'matrix notify %player% suspected using elytra-related cheats &8| &7Elytra &8| &c2/3'
    48: 'matrix kick %player% Elytra Flight'

## Vehicle
# Checks prevents player using VehicleFlight, VehicleSpeed, EntitySpeed..
# Only works for 1.9+
vehicle:
  # Enable this check?
  enable: true

  # Prevent players from using certain creatures as vehicles
  # All entity types: https://hub.spigotmc.org/javadocs/spigot/org/bukkit/entity/EntityType.html
  deny_entity_types_as_vehicle:

  # Vehicle Speed/ Entity Speed
  speed:
    # Enable this modules?
    enable: true

    # setback VL (-1 = disable setback)
    setback_vl: 2

  # Vehicle Flight / Boat Flight
  flight:
    # Enable this modules?
    enable: true

    # setback vl (-1 = never setback)
    setback_vl: 4

    # leave vehicle vl (-1 = never leave vehicle)
    leave_vehicle: 8

  # Violation Thresholds
  # number_of_violations: '<command>'
  commands:
    5: 'matrix notify %player% suspected using vehicle-related cheats &8| &7Vehicle &8| &a1/3'
    10: 'matrix notify %player% suspected using vehicle-related cheats &8| &7Vehicle &8| &c2/3'
    32: 'matrix kick %player% Suspicious vehicle movement'
